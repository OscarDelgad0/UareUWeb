const variables={};async function consultarAPIEmpleados(){try{const t="http://localhost:3000/APIEnviarEmpleados.php",a=await fetch(t);return await a.json()}catch(t){console.log(t)}}async function consultarAPIActualizacion(){try{const t="http://localhost:3000/APISensor.php",a=await fetch(t);return await a.json()}catch(t){console.log(t)}}async function consultarAPIHuella(){try{const t="http://localhost:3000/APISensor.php",a=await fetch(t);return await a.json()}catch(t){console.log(t)}}async function consultarAPIAsistencia(){try{const t="http://localhost:3000/APIUltimaHuella.php",a=await fetch(t);return await a.json()}catch(t){console.log(t)}}async function colocarEmpleados(){await consultarAPIEmpleados()}async function mostrarEmpleados(){const t=document.querySelector(".contenedor-empleados");if(t){(await consultarAPI()).forEach(a=>{const{id:o,nombre:e}=a,s=document.createElement("div"),n=document.createElement("P"),c=document.createElement("P");n.textContent=o,c.textContent=e,s.appendChild(n),s.appendChild(c),t.appendChild(s)})}}async function sensor(){const t=await consultarAPIActualizacion();var a=parseInt(t[0].status_asistencia),o=Boolean(a),e=parseInt(t[0].status_registro);Boolean(e);o&&console.log("Sin cambios"),o||(actualizarMenuAsistencia(),actualizarAsistencia(t))}async function actualizarAsistencia(t){const a=new FormData;for(const o in t[0])a.append(o,t[0][o]);a.append("status_asistencia",1);try{const t="http://localhost:3000/POSTCambios.php",o=await fetch(t,{method:"POST",body:a});await o.json()}catch(t){}}async function actualizarMenuAsistencia(){const t=document.querySelector(".detector-hora"),a=document.querySelector(".nombre-card-asistencia"),o=document.querySelector(".hora-card-asistencia"),e=document.querySelector(".notificacion-asistencia"),s=document.querySelector(".notificacion-asistencia-contenedor"),n=(document.querySelector(".tarde"),await consultarAPIAsistencia()),{nombre:c,hora_entrada:i,apellido:l}=n;var r=new Date,d=r.getHours(),p=r.getMinutes(),u=d,m=d>=12?"PM":"AM",h=(d=(d%=12)||12)+":"+(p=p<10?"0"+p:p)+" "+m,[f,y]=i.split(":"),L=60*(f=parseInt(f))+(y=parseInt(y)),w=60*(u=parseInt(u))+p;console.log(L),console.log(w),w<=L?(e.textContent="A tiempo",(s.classList.contains("atiempo")||s.classList.contains("falta")||s.classList.contains("retardo"))&&(s.classList.remove("atiempo"),s.classList.remove("falta"),s.classList.remove("retardo")),s.classList.add("atiempo")):w>L&&w<=L+10?(e.textContent="Retardo",(s.classList.contains("atiempo")||s.classList.contains("falta")||s.classList.contains("retardo"))&&(s.classList.remove("atiempo"),s.classList.remove("falta"),s.classList.remove("retardo")),s.classList.add("retardo")):(e.textContent="Falta",(s.classList.contains("atiempo")||s.classList.contains("falta")||s.classList.contains("retardo"))&&(s.classList.remove("atiempo"),s.classList.remove("falta"),s.classList.remove("retardo")),s.classList.add("falta")),o.textContent=h,a.textContent=c,t.classList.remove("visible"),setTimeout((function(){t.classList.add("visible")}),4200)}async function actualizarEmpleados(t){const{id:a,time_actualizacion_now:o,date_actualizacion_now:e,time_actualizacion_past:s,date_actualizacion_past:n}=t[0],c=new FormData;c.append("id",a),c.append("time_actualizacion_now",o),c.append("date_actualizacion_now",e),c.append("time_actualizacion_past",s),c.append("date_actualizacion_past",n),c.append("actualizacion","last");try{const t="http://localhost:3000/POSTCambios.php",a=await fetch(t,{method:"POST",body:c});await a.json()}catch(t){}}document.addEventListener("DOMContentLoaded",(function(){mostrarEmpleados(),sensor(),colocarEmpleados()}));